---   
layout:     post  
title:  以封杀宫廷剧来看如何清洗数据
description:  继综艺被封杀后，现在命运之剑终于射中了宫廷剧。  
keywords: 技术  
tags: [技术]    
categories: [技术]  
updateData: 2019-01-31 18:26 
published: false 
---  


## 一、封杀宫廷剧  


2019年1月30号，我看到了一个新闻。  
大概内容是广电总局要开始封杀宫廷剧了，卫视已经全面禁播了。  
既然这样，那网络上也不远了。  


当时我在朋友圈发布了一个状态：  
 

![](/images/2019/01/20190131202641.png)  


中午才发完这个朋友圈，晚上就收到消息，所有页面都要下掉“宫廷”两个字。  
从此，世上再无“宫廷”了。  


由于我处于视频行业，所以我所说的坏消息有很多面。  
其中的一面就是这个，这段时间对于很多人来说，都需要处理这个问题，甚至晚上都是一个不眠之夜或者睡不好觉了。  


## 二、写扩散与读计算  


对于一个视频，往往需要给视频打上一些标签，比如偶像、宫廷、玄幻、都市、喜剧、武打、悬疑等等。  


视频的数量少则几万，多则上亿，如果每个视频直接储存对应的文本标签，则存在一个写扩散问题。  
以宫廷为例，写扩散的具体含义就是所有的宫廷剧，都会储存“宫廷”这两个文字。  
突然有一天，我们要改名字了，那就需要将标签是宫廷的视频找出来，然后改成新的名字。  


面对这个问题，大家常见的解决方案是 ID 化。  
具体来说就是我们预先将所有的标签储存在一个地方，并分配一个唯一的数字。  
如果一个视频要和这个标签关联起来，这个视频储存对应的数字即可。  


这样做时读数据的时候麻烦一点，需要来一层计算。  
具体是第一次只能通过视频ID查出标签ID，然后还需要再通过标签ID来查询标签对应的含义。   


当然，通过这样一个小代价，我们就解决了上面的写扩散问题。  
再来修改标签的含义时，我们只需要对应标签表里标签ID对应的含义。  
这样读数据的时候，只修改一个标签字典表，所有页面的数据都可以瞬间生效了。  


这个就对应上了一句名言：任何问题都可以通过加一层来解决。  


## 三、读计算与缓存  











-EOF-  


本文首发于公众号：天空的代码世界，微信号：tiankonguse-code。  
原文地址： [https://mp.weixin.qq.com/s/VF70iQxioir5r1xHxYT-pw](https://mp.weixin.qq.com/s/VF70iQxioir5r1xHxYT-pw)  
  
